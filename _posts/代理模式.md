---
title: 代理模式
categories:
  - 笔记
tags:
  - 代理模式
  - 正向代理
  - 反向代理
date: 2018-08-04 15:03:50
---
 这是摘要
 <!-- more -->


## 正向代理
{% asset_img 多进程多线程的对比.png 多进程多线程的对比%}
正向代理的用途
1. 突破访问限制
通过代理服务器，可以突破自身IP访问限制，访问国外网站，教育网等。
2. 提高访问速度 通常代理服务器都设置一个较大的硬盘缓冲区，会将部分请求的响应保存到缓冲区中，当其他用户再访问相同的信息时,则直接由缓冲区中取出信息，传给用户，以提高访问速度。
3. 隐藏客户端真实IP 
上网者也可以通过这种方法隐藏自己的IP，免受攻击。

## 反向代理
{% asset_img 反向代理.png 反向代理%}
1. 隐藏服务器真实IP 
使用反向代理，可以对客户端隐藏服务器的IP地址。
2. 负载均衡 
反向代理服务器可以做负载均衡，根据所有真实服务器的负载情况，将客户端请求分发到不同的真实服务器上。
3. 提高访问速度 
反向代理服务器可以对于静态内容及短时间内有大量访问请求的动态内容提供缓存服务，提高访问速度。
4. 提供安全保障 
反向代理服务器可以作为应用层防火墙，为网站提供对基于Web的攻击行为（例如DoS/DDoS）的防护，更容易排查恶意软件等。还可以为后端服务器统一提供加密和SSL加速（如SSL终端代理），提供HTTP访问认证等。

## 代理模式
### 静态代理
{% asset_img 静态代理.png 静态代理%}
创建代理的步骤:
1. 首先定义一个代理类并实现要代理的接口
2. 将要代理的接口声明为成员属性,一种是直接new一个要代理的对象(这种方式下使用代理的人甚至都不知道被代理对象的存在),另一种是将要代理的对象作为参数传入(这样就和装饰模式有点像)
3. 定义代理类的构造函数,在构造函数张
4. 实现接口的方法,并在方法中调用构造函数中传入的代理对象的方法,这个时候就可以对代理对象进行加强或者拦截

### 动态代理
参考地址:http://xvshell.iteye.com/blog/2363443
参考地址:http://www.jasongj.com/design_pattern/proxy_decorator/
1. JDK动态代理:适用于要代理的业务类实现接口的情况
2. CGlib代理:适用于要代理的业务类没有实现接口的情况
代理模式可以对代理对象进行增强,不过主要还是对代理对象的访问进行拦截


### 代理模式的应用
* 简单静态代理模式
	1. 适合使用在需要代理的类不多且确定的场景
	比如日志,就是写一个代理类,实现代理对象的实现的接口,接受代理对象作为成员变量,然后在调用代理对象方法前后增加日志,这种代理能解耦,但是无法减少代码量
* JDK动态代理(参考地址:https://blog.csdn.net/bjyfb/article/details/7350256)
	1. 比静态代理灵活,但是前提是代理目标有实现接口
		
* CGlib动态代理(适用于代理对象没有实现接口的场景)
















